# れどめというなのメモ書き

remohardsw

Remote Hardware Switching System (RHSS)

サーバーなどがソフトウエア上の入力を受け付けなくなった場合に独立したハードウエアからリモートでターゲットサーバーの電源を物理的に操作する仕組みの構築


必要環境
1.RHSSへアクセス可能なネットワーク
2.RHSSへの電源供給

RHSSの構成
独立したハードウエアかつセキュアなネットワーク接続が可能な小型サーバー
ハードウエアスイッチ（リレー）をコントロール可能なIO

Raspberry Pi 3 or 4
Raspberry Pi用リレーシールド of GPIOでのコントロールが可能なリレーユニット
オプション RS-232C

MyTerminal <-ssh-> Raspberry Pi <-GPIO-> リレーユニット <-> マザーボード上のReset,Powerスイッチ

マザーボードのリセット、パワースイッチはショートさせるだけで動作するのでリレーにつなぐだけでコントロールできる
リレーユニットは絶縁をされておりM/B上のスイッチとラズパイ等は電気的に接点を持たない
予備としてシリアル接続を持った場合は別である

Ras Piとターゲットサーバーをシリアル接続するメリット・デメリット
sshやfirewallなどの設定を間違えた場合でもリモートでリカバリー可能である
外部からターミナルへアクセスする経路が増えるため脆弱さを抱えることになる

RasPi IOを利用したサーバー電源ランプ監視
通常マザーボードからはステータスLEDのために1-3v程度の電気が流れているためこれを感知することで完全なハードウエア上のON,OFF状態が確認できる
